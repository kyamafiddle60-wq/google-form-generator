# 🔧 Google Apps Script セットアップガイド

## 📋 概要

このガイドでは、Google Apps Scriptをセットアップして、Chrome拡張機能から呼び出せるようにします。

**所要時間**: 約15分

---

## 🎯 セットアップの流れ

1. Google Apps Scriptを開く
2. プロジェクトを作成
3. コードを貼り付け
4. テスト実行
5. デプロイ
6. URLを取得

---

## ステップ1: Google Apps Scriptを開く

### 1-1. ブラウザでアクセス

1. Google Chromeを開く
2. 以下のURLをコピーして、アドレスバーに貼り付けてEnterキーを押す

```
https://script.google.com/home
```

3. Googleアカウントでログインしていない場合は、ログインする

### 1-2. 画面の確認

- 「マイ プロジェクト」という画面が表示されればOKです
- 初めての場合は何も表示されていないかもしれませんが、問題ありません

---

## ステップ2: 新しいプロジェクトを作成

### 2-1. プロジェクトを作成

1. 画面左上の **「新しいプロジェクト」** ボタンをクリック
   - 青い「＋」マークのボタンです
   
2. 新しいタブで、コードエディタ画面が開きます

### 2-2. プロジェクト名を変更（推奨）

1. 画面左上の「無題のプロジェクト」をクリック
2. 「Googleフォーム自動作成」と入力
3. 「OK」をクリック

---

## ステップ3: コードを貼り付ける

### 3-1. 既存のコードを削除

1. エディタに以下のようなコードが表示されています：

```javascript
function myFunction() {

}
```

2. このコードを**すべて選択**して削除します
   - `Ctrl + A`（Mac: `Command + A`）で全選択
   - `Delete`キーで削除

### 3-2. 新しいコードを貼り付け

1. `Google_Apps_Script_コード.js` ファイルを開く
2. コードを**すべてコピー**します
3. エディタに**貼り付け**ます（`Ctrl + V` または Mac: `Command + V`）

### 3-3. 保存

コードが貼り付けられたら、**保存**します
   - `Ctrl + S`（Mac: `Command + S`）
   - または画面上部の「💾（保存）」アイコンをクリック

---

## ステップ4: 動作テスト（重要！）

コードが正しく動作するか確認します。

### 4-1. テスト関数を実行

1. 画面上部の関数選択ドロップダウン（「myFunction」と表示されている部分）をクリック
2. **「testCreateForm」** を選択
3. 右側の **「▶実行」** ボタンをクリック

### 4-2. 権限の承認（初回のみ）

初めて実行する時は、権限の確認画面が表示されます：

1. **「権限を確認」** ボタンをクリック
2. Googleアカウントを選択
3. **「詳細」** をクリック（警告画面が出た場合）
4. **「Googleフォーム自動作成（安全ではないページ）に移動」** をクリック
   - 「安全ではない」と表示されますが、自分で作成したスクリプトなので問題ありません
5. **「許可」** ボタンをクリック

### 4-3. 実行結果を確認

1. 実行が完了するまで数秒待ちます
2. 画面下部の「実行ログ」をクリック
3. 以下のようなログが表示されればOKです：

```
✅ フォーム作成成功！
URL: https://docs.google.com/forms/d/xxxxx/edit
```

4. このURLをクリックすると、実際に作成されたテストフォームが開きます
   - フォームが表示されれば、正常に動作しています！

### 4-4. エラーが出た場合

エラーメッセージが表示された場合：
1. コードが正しく貼り付けられているか確認
2. コピー&ペーストを最初からやり直す
3. それでもエラーが出る場合は、エラーメッセージをメモしておく

---

## ステップ5: Webアプリとして公開

### 5-1. デプロイを開始

1. 画面右上の **「デプロイ」** ボタンをクリック
2. **「新しいデプロイ」** を選択

### 5-2. デプロイの設定

1. 左側の「⚙️（設定）」アイコンをクリック
2. **「種類の選択」** から **「ウェブアプリ」** を選択

3. 以下の設定を行います：

```
📝 説明（オプション）: Googleフォーム自動作成API

👤 次のユーザーとして実行:
   → 「自分」を選択

🌐 アクセスできるユーザー:
   → 「全員」を選択（重要！）
```

4. **「デプロイ」** ボタンをクリック

### 5-3. URLをコピー

1. **「ウェブアプリ」** の下に表示されるURLをコピーします
   ```
   https://script.google.com/macros/s/AKfycbxxx.../exec
   ```
2. このURLは後で使うので、メモ帳などに保存しておいてください
3. **「完了」** ボタンをクリック

---

## ✅ 完了！

これでGoogle Apps Scriptの準備は完了です。

**重要**: コピーしたURLを安全な場所に保存してください。Chrome拡張機能の設定で使用します。

---

## ❓ トラブルシューティング

### 問題1: 権限エラーが出る

**症状**: 「権限が不足しています」と表示される

**解決法**:
1. 権限の確認画面で「許可」をクリック
2. それでもエラーが出る場合は、Googleアカウントでログインし直す

### 問題2: コードが貼り付けられない

**症状**: コードが正しく貼り付けられない

**解決法**:
1. 既存のコードをすべて削除
2. 一度にすべてのコードをコピー&ペースト
3. 保存を忘れずに

### 問題3: テスト関数が実行できない

**症状**: 「実行」ボタンが押せない

**解決法**:
1. 関数選択で「testCreateForm」が選択されているか確認
2. コードが保存されているか確認
3. ブラウザをリフレッシュ

### 問題4: URLが表示されない

**症状**: テスト関数を実行してもURLが表示されない

**解決法**:
- これは正常な動作です
- フォームはGoogle Driveに作成されています
- デプロイに進んでください

---

## 📞 サポート

問題が解決しない場合：

1. **エラーメッセージを確認**
2. **Google Apps Scriptのログを確認**
3. **ブラウザをリフレッシュして再試行**

---

**次のステップ**: `Chrome拡張機能_インストール.md` を参照してください。

---

**バージョン**: 1.0  
**最終更新**: 2025年10月16日
