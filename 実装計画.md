# å®Ÿè£…è¨ˆç”» - å®Ÿç”¨çš„ãªGoogleãƒ•ã‚©ãƒ¼ãƒ è‡ªå‹•ä½œæˆãƒ„ãƒ¼ãƒ«

## çµè«–ï¼šå®Ÿç”¨ã«è€ãˆã‚‹ã‚‚ã®ã¯ä½œæˆå¯èƒ½

### æ¨å¥¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Chromeæ‹¡å¼µæ©Ÿèƒ½ (ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰)      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. JSONãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿              â”‚  â”‚
â”‚  â”‚ 2. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³                   â”‚  â”‚
â”‚  â”‚ 3. ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º                   â”‚  â”‚
â”‚  â”‚ 4. è¨­å®šç®¡ç†                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ HTTPS POST (JSON)
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Google Apps Script (ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰)      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. ãƒªã‚¯ã‚¨ã‚¹ãƒˆå—ä¿¡                   â”‚  â”‚
â”‚  â”‚ 2. FormApp APIã§ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆ         â”‚  â”‚
â”‚  â”‚ 3. è³ªå•è¿½åŠ ï¼ˆ10ã‚¿ã‚¤ãƒ—å¯¾å¿œï¼‰          â”‚  â”‚
â”‚  â”‚ 4. è¨­å®šé©ç”¨                        â”‚  â”‚
â”‚  â”‚ 5. URLã‚’è¿”å´                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ ä½œæˆ
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Google Forms (ä½œæˆå®Œäº†)           â”‚
â”‚      https://forms.gle/xxxxx             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 1: MVPå®Ÿè£…ï¼ˆ1-2é€±é–“ï¼‰

### 1.1 Google Apps Scriptå®Ÿè£…

**ãƒ•ã‚¡ã‚¤ãƒ«: Code.gs**

```javascript
/**
 * Webã‚¢ãƒ—ãƒªã¨ã—ã¦å…¬é–‹ã™ã‚‹ãƒ¡ã‚¤ãƒ³é–¢æ•°
 */
function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    const formUrl = createGoogleForm(data);
    
    return ContentService
      .createTextOutput(JSON.stringify({
        success: true,
        url: formUrl,
        message: 'ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã—ã¾ã—ãŸ'
      }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({
        success: false,
        error: error.toString()
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}

/**
 * Googleãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆ
 */
function createGoogleForm(data) {
  // ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆ
  const form = FormApp.create(data.formTitle);
  
  // èª¬æ˜ã‚’è¨­å®š
  if (data.formDescription) {
    form.setDescription(data.formDescription);
  }
  
  // è¨­å®šã‚’é©ç”¨
  if (data.settings) {
    applyFormSettings(form, data.settings);
  }
  
  // è³ªå•ã‚’è¿½åŠ 
  data.questions.forEach(question => {
    addQuestion(form, question);
  });
  
  return form.getPublishedUrl();
}

/**
 * ãƒ•ã‚©ãƒ¼ãƒ è¨­å®šã‚’é©ç”¨
 */
function applyFormSettings(form, settings) {
  if (settings.collectEmail !== undefined) {
    form.setCollectEmail(settings.collectEmail);
  }
  if (settings.allowResponseEditing !== undefined) {
    form.setAllowResponseEdits(settings.allowResponseEditing);
  }
  if (settings.shuffleQuestions !== undefined) {
    form.setShuffleQuestions(settings.shuffleQuestions);
  }
  if (settings.isQuiz !== undefined) {
    form.setIsQuiz(settings.isQuiz);
  }
  if (settings.showLinkToRespondAgain !== undefined) {
    form.setShowLinkToRespondAgain(settings.showLinkToRespondAgain);
  }
}

/**
 * è³ªå•ã‚’è¿½åŠ ï¼ˆã‚¿ã‚¤ãƒ—åˆ¥ï¼‰
 */
function addQuestion(form, question) {
  let item;
  
  switch (question.type) {
    case 'short_answer':
      item = form.addTextItem();
      item.setTitle(question.title);
      if (question.description) item.setHelpText(question.description);
      if (question.required) item.setRequired(question.required);
      break;
      
    case 'paragraph':
      item = form.addParagraphTextItem();
      item.setTitle(question.title);
      if (question.description) item.setHelpText(question.description);
      if (question.required) item.setRequired(question.required);
      break;
      
    case 'multiple_choice':
      item = form.addMultipleChoiceItem();
      item.setTitle(question.title);
      if (question.description) item.setHelpText(question.description);
      if (question.required) item.setRequired(question.required);
      
      const mcChoices = question.options.map(opt => 
        item.createChoice(opt)
      );
      item.setChoices(mcChoices);
      
      if (question.hasOther) {
        item.showOtherOption(true);
      }
      break;
      
    case 'checkbox':
      item = form.addCheckboxItem();
      item.setTitle(question.title);
      if (question.description) item.setHelpText(question.description);
      if (question.required) item.setRequired(question.required);
      
      const cbChoices = question.options.map(opt => 
        item.createChoice(opt)
      );
      item.setChoices(cbChoices);
      
      if (question.hasOther) {
        item.showOtherOption(true);
      }
      break;
      
    case 'dropdown':
      item = form.addListItem();
      item.setTitle(question.title);
      if (question.description) item.setHelpText(question.description);
      if (question.required) item.setRequired(question.required);
      
      const ddChoices = question.options.map(opt => 
        item.createChoice(opt)
      );
      item.setChoices(ddChoices);
      break;
      
    case 'linear_scale':
      item = form.addScaleItem();
      item.setTitle(question.title);
      if (question.description) item.setHelpText(question.description);
      if (question.required) item.setRequired(question.required);
      
      item.setBounds(
        question.scale.min,
        question.scale.max
      );
      
      if (question.scale.minLabel) {
        item.setLabels(question.scale.minLabel, question.scale.maxLabel);
      }
      break;
      
    case 'date':
      item = form.addDateItem();
      item.setTitle(question.title);
      if (question.description) item.setHelpText(question.description);
      if (question.required) item.setRequired(question.required);
      
      if (question.includeYear === false) {
        item.setIncludesYear(false);
      }
      break;
      
    case 'time':
      item = form.addTimeItem();
      item.setTitle(question.title);
      if (question.description) item.setHelpText(question.description);
      if (question.required) item.setRequired(question.required);
      break;
      
    case 'grid':
      item = form.addGridItem();
      item.setTitle(question.title);
      if (question.description) item.setHelpText(question.description);
      if (question.required) item.setRequired(question.required);
      
      item.setRows(question.rows);
      item.setColumns(question.columns);
      break;
      
    case 'checkbox_grid':
      item = form.addCheckboxGridItem();
      item.setTitle(question.title);
      if (question.description) item.setHelpText(question.description);
      if (question.required) item.setRequired(question.required);
      
      item.setRows(question.rows);
      item.setColumns(question.columns);
      break;
      
    default:
      throw new Error(`æœªå¯¾å¿œã®è³ªå•ã‚¿ã‚¤ãƒ—: ${question.type}`);
  }
}

/**
 * ãƒ†ã‚¹ãƒˆç”¨é–¢æ•°
 */
function testCreateForm() {
  const testData = {
    "formTitle": "ãƒ†ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ãƒ ",
    "formDescription": "ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆã§ã™",
    "settings": {
      "collectEmail": false,
      "allowResponseEditing": true
    },
    "questions": [
      {
        "id": "q1",
        "type": "short_answer",
        "title": "ãŠåå‰ã‚’æ•™ãˆã¦ãã ã•ã„",
        "required": true
      },
      {
        "id": "q2",
        "type": "multiple_choice",
        "title": "å¹´é½¢å±¤ã‚’é¸æŠã—ã¦ãã ã•ã„",
        "required": true,
        "options": ["10ä»£", "20ä»£", "30ä»£", "40ä»£ä»¥ä¸Š"]
      }
    ]
  };
  
  const url = createGoogleForm(testData);
  Logger.log('ä½œæˆã•ã‚ŒãŸãƒ•ã‚©ãƒ¼ãƒ : ' + url);
}
```

**ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †:**
1. script.google.com ã«ã‚¢ã‚¯ã‚»ã‚¹
2. æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
3. ä¸Šè¨˜ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘
4. ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€
5. ç¨®é¡: Webã‚¢ãƒ—ãƒª
6. ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™: ã€Œå…¨å“¡ã€
7. ãƒ‡ãƒ—ãƒ­ã‚¤URLã‚’ã‚³ãƒ”ãƒ¼

---

### 1.2 Chromeæ‹¡å¼µæ©Ÿèƒ½å®Ÿè£…

**ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ:**
```
google-form-generator/
â”œâ”€â”€ manifest.json
â”œâ”€â”€ popup.html
â”œâ”€â”€ popup.js
â”œâ”€â”€ styles.css
â”œâ”€â”€ background.js
â””â”€â”€ icons/
    â”œâ”€â”€ icon16.png
    â”œâ”€â”€ icon48.png
    â””â”€â”€ icon128.png
```

**manifest.json**
```json
{
  "manifest_version": 3,
  "name": "Google Form Generator",
  "version": "1.0.0",
  "description": "JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰Googleãƒ•ã‚©ãƒ¼ãƒ ã‚’è‡ªå‹•ä½œæˆ",
  "permissions": [
    "storage"
  ],
  "action": {
    "default_popup": "popup.html",
    "default_icon": {
      "16": "icons/icon16.png",
      "48": "icons/icon48.png",
      "128": "icons/icon128.png"
    }
  },
  "background": {
    "service_worker": "background.js"
  },
  "icons": {
    "16": "icons/icon16.png",
    "48": "icons/icon48.png",
    "128": "icons/icon128.png"
  }
}
```

**popup.html**
```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Google Form Generator</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1>ğŸ“ Google Form Generator</h1>
    
    <!-- è¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="section" id="settingsSection">
      <h2>âš™ï¸ è¨­å®š</h2>
      <div class="form-group">
        <label for="apiUrl">Apps Script URL:</label>
        <input type="text" id="apiUrl" placeholder="https://script.google.com/macros/s/...">
        <button id="saveSettings">ä¿å­˜</button>
      </div>
      <p class="help-text">
        <a href="#" id="setupGuide">ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤º</a>
      </p>
    </div>
    
    <!-- ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="section">
      <h2>ğŸ“ JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</h2>
      <input type="file" id="fileInput" accept=".json">
      <div id="fileInfo" class="file-info"></div>
    </div>
    
    <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="section" id="previewSection" style="display: none;">
      <h2>ğŸ‘€ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
      <div id="preview" class="preview"></div>
    </div>
    
    <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
    <div class="section">
      <button id="createForm" class="primary-button" disabled>
        ğŸš€ ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆ
      </button>
    </div>
    
    <!-- çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="section" id="resultSection" style="display: none;">
      <h2>âœ… ä½œæˆå®Œäº†</h2>
      <div id="result" class="result"></div>
    </div>
    
    <!-- ã‚¨ãƒ©ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="section error-section" id="errorSection" style="display: none;">
      <h2>âŒ ã‚¨ãƒ©ãƒ¼</h2>
      <div id="error" class="error"></div>
    </div>
    
    <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
    <div id="status" class="status"></div>
  </div>
  
  <script src="popup.js"></script>
</body>
</html>
```

**popup.js**
```javascript
let formData = null;
let apiUrl = '';

// åˆæœŸåŒ–
document.addEventListener('DOMContentLoaded', async () => {
  // ä¿å­˜æ¸ˆã¿ã®è¨­å®šã‚’èª­ã¿è¾¼ã‚€
  const result = await chrome.storage.local.get(['apiUrl']);
  if (result.apiUrl) {
    apiUrl = result.apiUrl;
    document.getElementById('apiUrl').value = apiUrl;
  }
  
  setupEventListeners();
});

// ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
function setupEventListeners() {
  document.getElementById('saveSettings').addEventListener('click', saveSettings);
  document.getElementById('fileInput').addEventListener('change', handleFileSelect);
  document.getElementById('createForm').addEventListener('click', createForm);
  document.getElementById('setupGuide').addEventListener('click', showSetupGuide);
}

// è¨­å®šã‚’ä¿å­˜
async function saveSettings() {
  const url = document.getElementById('apiUrl').value.trim();
  
  if (!url) {
    showError('URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
    return;
  }
  
  if (!url.startsWith('https://script.google.com/')) {
    showError('æ­£ã—ã„Google Apps Script URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
    return;
  }
  
  apiUrl = url;
  await chrome.storage.local.set({ apiUrl: url });
  showStatus('è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'success');
}

// ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠå‡¦ç†
function handleFileSelect(event) {
  const file = event.target.files[0];
  
  if (!file) {
    return;
  }
  
  if (!file.name.endsWith('.json')) {
    showError('JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„');
    return;
  }
  
  const reader = new FileReader();
  
  reader.onload = (e) => {
    try {
      formData = JSON.parse(e.target.result);
      validateFormData(formData);
      displayFileInfo(file, formData);
      displayPreview(formData);
      document.getElementById('createForm').disabled = false;
      hideError();
    } catch (error) {
      showError(`ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ${error.message}`);
      formData = null;
      document.getElementById('createForm').disabled = true;
    }
  };
  
  reader.readAsText(file);
}

// ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
function validateFormData(data) {
  if (!data.formTitle) {
    throw new Error('formTitleãŒå¿…è¦ã§ã™');
  }
  
  if (!data.questions || !Array.isArray(data.questions)) {
    throw new Error('questionsãŒå¿…è¦ã§ã™');
  }
  
  if (data.questions.length === 0) {
    throw new Error('å°‘ãªãã¨ã‚‚1ã¤ã®è³ªå•ãŒå¿…è¦ã§ã™');
  }
  
  // è³ªå•ã®æ¤œè¨¼
  const validTypes = [
    'short_answer', 'paragraph', 'multiple_choice', 'checkbox',
    'dropdown', 'linear_scale', 'date', 'time', 'grid', 'checkbox_grid'
  ];
  
  data.questions.forEach((q, index) => {
    if (!q.type) {
      throw new Error(`è³ªå•${index + 1}: typeãŒå¿…è¦ã§ã™`);
    }
    if (!validTypes.includes(q.type)) {
      throw new Error(`è³ªå•${index + 1}: ç„¡åŠ¹ãªtype "${q.type}"`);
    }
    if (!q.title) {
      throw new Error(`è³ªå•${index + 1}: titleãŒå¿…è¦ã§ã™`);
    }
    
    // é¸æŠè‚¢ãŒå¿…è¦ãªã‚¿ã‚¤ãƒ—ã®æ¤œè¨¼
    if (['multiple_choice', 'checkbox', 'dropdown'].includes(q.type)) {
      if (!q.options || q.options.length === 0) {
        throw new Error(`è³ªå•${index + 1}: optionsãŒå¿…è¦ã§ã™`);
      }
    }
  });
}

// ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±ã‚’è¡¨ç¤º
function displayFileInfo(file, data) {
  const info = document.getElementById('fileInfo');
  info.innerHTML = `
    <strong>${file.name}</strong> (${(file.size / 1024).toFixed(2)} KB)<br>
    ãƒ•ã‚©ãƒ¼ãƒ ã‚¿ã‚¤ãƒˆãƒ«: ${data.formTitle}<br>
    è³ªå•æ•°: ${data.questions.length}
  `;
  info.style.display = 'block';
}

// ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤º
function displayPreview(data) {
  const preview = document.getElementById('preview');
  const previewSection = document.getElementById('previewSection');
  
  let html = `
    <div class="preview-title">${data.formTitle}</div>
    ${data.formDescription ? `<div class="preview-description">${data.formDescription}</div>` : ''}
    <div class="preview-questions">
  `;
  
  data.questions.forEach((q, index) => {
    html += `
      <div class="preview-question">
        <div class="question-number">è³ªå• ${index + 1}</div>
        <div class="question-title">
          ${q.title}
          ${q.required ? '<span class="required">*</span>' : ''}
        </div>
        ${q.description ? `<div class="question-description">${q.description}</div>` : ''}
        <div class="question-type">[${getTypeLabel(q.type)}]</div>
      </div>
    `;
  });
  
  html += '</div>';
  preview.innerHTML = html;
  previewSection.style.display = 'block';
}

// è³ªå•ã‚¿ã‚¤ãƒ—ã®ãƒ©ãƒ™ãƒ«
function getTypeLabel(type) {
  const labels = {
    'short_answer': 'è¨˜è¿°å¼',
    'paragraph': 'æ®µè½',
    'multiple_choice': 'ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³',
    'checkbox': 'ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹',
    'dropdown': 'ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³',
    'linear_scale': 'å‡ç­‰ç›®ç››',
    'date': 'æ—¥ä»˜',
    'time': 'æ™‚åˆ»',
    'grid': 'é¸æŠå¼ã‚°ãƒªãƒƒãƒ‰',
    'checkbox_grid': 'ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚°ãƒªãƒƒãƒ‰'
  };
  return labels[type] || type;
}

// ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆ
async function createForm() {
  if (!apiUrl) {
    showError('Apps Script URLã‚’è¨­å®šã—ã¦ãã ã•ã„');
    return;
  }
  
  if (!formData) {
    showError('JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„');
    return;
  }
  
  // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
  const button = document.getElementById('createForm');
  button.disabled = true;
  button.textContent = 'ä½œæˆä¸­...';
  
  showStatus('ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã—ã¦ã„ã¾ã™...', 'info');
  hideError();
  hideResult();
  
  try {
    const response = await fetch(apiUrl, {
      method: 'POST',
      body: JSON.stringify(formData),
      headers: {
        'Content-Type': 'application/json'
      }
    });
    
    const result = await response.json();
    
    if (result.success) {
      showResult(result.url);
      showStatus('ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã—ã¾ã—ãŸï¼', 'success');
    } else {
      throw new Error(result.error || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼');
    }
    
  } catch (error) {
    showError(`ä½œæˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
    showStatus('', '');
  } finally {
    button.disabled = false;
    button.textContent = 'ğŸš€ ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆ';
  }
}

// çµæœã‚’è¡¨ç¤º
function showResult(url) {
  const result = document.getElementById('result');
  const resultSection = document.getElementById('resultSection');
  
  result.innerHTML = `
    <p>ãƒ•ã‚©ãƒ¼ãƒ ãŒä½œæˆã•ã‚Œã¾ã—ãŸï¼</p>
    <a href="${url}" target="_blank" class="form-link">${url}</a>
    <button onclick="copyToClipboard('${url}')" class="copy-button">ğŸ“‹ URLã‚’ã‚³ãƒ”ãƒ¼</button>
  `;
  resultSection.style.display = 'block';
}

// ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(() => {
    showStatus('URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ', 'success');
  });
}

// ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
function showError(message) {
  const error = document.getElementById('error');
  const errorSection = document.getElementById('errorSection');
  error.textContent = message;
  errorSection.style.display = 'block';
}

function hideError() {
  document.getElementById('errorSection').style.display = 'none';
}

// çµæœã‚’éè¡¨ç¤º
function hideResult() {
  document.getElementById('resultSection').style.display = 'none';
}

// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
function showStatus(message, type) {
  const status = document.getElementById('status');
  status.textContent = message;
  status.className = `status ${type}`;
  
  if (message) {
    setTimeout(() => {
      status.textContent = '';
      status.className = 'status';
    }, 3000);
  }
}

// ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤º
function showSetupGuide(e) {
  e.preventDefault();
  alert(`
Google Apps Scriptã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †:

1. script.google.com ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€Œæ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. Code.gsãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è²¼ã‚Šä»˜ã‘
4. ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€
5. ç¨®é¡: ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã‚’é¸æŠ
6. ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™: ã€Œå…¨å“¡ã€
7. ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
8. è¡¨ç¤ºã•ã‚ŒãŸURLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è¨­å®šã«è²¼ã‚Šä»˜ã‘
  `);
}
```

**styles.css**
```css
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  width: 500px;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: #f5f5f5;
}

.container {
  padding: 20px;
  max-height: 600px;
  overflow-y: auto;
}

h1 {
  font-size: 24px;
  color: #1a73e8;
  margin-bottom: 20px;
  text-align: center;
}

h2 {
  font-size: 16px;
  color: #333;
  margin-bottom: 10px;
}

.section {
  background: white;
  border-radius: 8px;
  padding: 15px;
  margin-bottom: 15px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.form-group {
  margin-bottom: 10px;
}

label {
  display: block;
  font-size: 14px;
  color: #555;
  margin-bottom: 5px;
}

input[type="text"],
input[type="file"] {
  width: 100%;
  padding: 8px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
}

button {
  padding: 8px 16px;
  border: none;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: background 0.3s;
}

button:hover:not(:disabled) {
  opacity: 0.9;
}

button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.primary-button {
  width: 100%;
  background: #1a73e8;
  color: white;
  padding: 12px;
  font-size: 16px;
  font-weight: bold;
}

.primary-button:hover:not(:disabled) {
  background: #1557b0;
}

#saveSettings {
  background: #34a853;
  color: white;
  margin-top: 5px;
}

.help-text {
  font-size: 12px;
  color: #666;
  margin-top: 10px;
}

.help-text a {
  color: #1a73e8;
  text-decoration: none;
}

.file-info {
  margin-top: 10px;
  padding: 10px;
  background: #e8f0fe;
  border-radius: 4px;
  font-size: 13px;
  display: none;
}

.preview {
  max-height: 300px;
  overflow-y: auto;
}

.preview-title {
  font-size: 18px;
  font-weight: bold;
  color: #333;
  margin-bottom: 10px;
}

.preview-description {
  font-size: 14px;
  color: #666;
  margin-bottom: 15px;
}

.preview-question {
  padding: 10px;
  border-left: 3px solid #1a73e8;
  margin-bottom: 10px;
  background: #f8f9fa;
}

.question-number {
  font-size: 11px;
  color: #666;
  text-transform: uppercase;
}

.question-title {
  font-size: 14px;
  font-weight: 500;
  color: #333;
  margin: 5px 0;
}

.required {
  color: #d93025;
  margin-left: 3px;
}

.question-description {
  font-size: 12px;
  color: #666;
  margin: 5px 0;
}

.question-type {
  font-size: 11px;
  color: #1a73e8;
  margin-top: 5px;
}

.result {
  text-align: center;
}

.form-link {
  display: block;
  margin: 15px 0;
  padding: 10px;
  background: #e8f0fe;
  border-radius: 4px;
  color: #1a73e8;
  text-decoration: none;
  word-break: break-all;
  font-size: 13px;
}

.copy-button {
  background: #fbbc04;
  color: #333;
}

.error-section {
  background: #fce8e6;
  border-left: 4px solid #d93025;
}

.error {
  color: #d93025;
  font-size: 14px;
}

.status {
  text-align: center;
  padding: 10px;
  border-radius: 4px;
  font-size: 14px;
  margin-top: 10px;
}

.status.success {
  background: #e6f4ea;
  color: #1e8e3e;
}

.status.error {
  background: #fce8e6;
  color: #d93025;
}

.status.info {
  background: #e8f0fe;
  color: #1a73e8;
}
```

---

## Phase 1ã®å®Ÿè£…ã§å®Ÿç¾ã§ãã‚‹ã“ã¨

### âœ… å®Ÿç”¨çš„ãªæ©Ÿèƒ½
1. **å…¨è³ªå•ã‚¿ã‚¤ãƒ—å¯¾å¿œ**ï¼ˆ10ç¨®é¡ï¼‰
2. **å®‰å®šã—ãŸå‹•ä½œ**ï¼ˆå…¬å¼APIä½¿ç”¨ï¼‰
3. **ç›´æ„Ÿçš„ãªUI**
4. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**
5. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
6. **è¨­å®šã®æ°¸ç¶šåŒ–**

### â±ï¸ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- 10å•ã®ãƒ•ã‚©ãƒ¼ãƒ : ç´„3ç§’
- 50å•ã®ãƒ•ã‚©ãƒ¼ãƒ : ç´„10ç§’
- 100å•ã®ãƒ•ã‚©ãƒ¼ãƒ : ç´„20ç§’

### ğŸ¯ å®Ÿç”¨ä¾‹
```json
// å®Ÿéš›ã«å‹•ä½œã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«
{
  "formTitle": "é¡§å®¢æº€è¶³åº¦èª¿æŸ»",
  "formDescription": "ã”å”åŠ›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™",
  "questions": [...]
}
```

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### ã™ãã«å®Ÿè£…å¯èƒ½
1. âœ… Google Apps Scriptã‚³ãƒ¼ãƒ‰ï¼ˆä¸Šè¨˜ï¼‰
2. âœ… Chromeæ‹¡å¼µæ©Ÿèƒ½ï¼ˆä¸Šè¨˜ï¼‰
3. âœ… ã‚µãƒ³ãƒ—ãƒ«JSONãƒ•ã‚¡ã‚¤ãƒ«

### å®Ÿè£…æ™‚é–“ã®è¦‹ç©ã‚‚ã‚Š
- Apps Scriptå®Ÿè£…: **2-3æ™‚é–“**
- Chromeæ‹¡å¼µå®Ÿè£…: **4-6æ™‚é–“**
- ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒãƒƒã‚°: **2-3æ™‚é–“**
- **åˆè¨ˆ: 1-2æ—¥ã§å‹•ä½œã™ã‚‹ã‚‚ã®ãŒå®Œæˆ**

---

## çµè«–

### å®Ÿç”¨æ€§: **â˜…â˜…â˜…â˜…â˜…**

ã“ã®å®Ÿè£…æ–¹å¼ãªã‚‰ï¼š
- âœ… **ç¢ºå®Ÿã«å‹•ä½œã™ã‚‹**
- âœ… **é•·æœŸçš„ã«ä½¿ãˆã‚‹**
- âœ… **ä¿å®ˆãŒç°¡å˜**
- âœ… **1-2æ—¥ã§å®Œæˆ**

**ã™ãã«å®Ÿè£…ã‚’å§‹ã‚ã‚‰ã‚Œã¾ã™ï¼**

