# ğŸ“ Googleãƒ•ã‚©ãƒ¼ãƒ è‡ªå‹•ä½œæˆãƒ„ãƒ¼ãƒ« - å®Œå…¨ã‚¬ã‚¤ãƒ‰

ChatGPTã§ç”Ÿæˆã—ãŸJSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã€Googleãƒ•ã‚©ãƒ¼ãƒ ã‚’è‡ªå‹•ä½œæˆã™ã‚‹Chromeæ‹¡å¼µæ©Ÿèƒ½ã§ã™ã€‚

## âœ¨ ä¸»ãªæ©Ÿèƒ½

- âœ… **JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆ**
- âœ… **10ç¨®é¡ã®è³ªå•ã‚¿ã‚¤ãƒ—ã«å¯¾å¿œ**
- âœ… **ChatGPTé€£æº**
- âœ… **ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½**
- âœ… **å®Œå…¨æ—¥æœ¬èªå¯¾å¿œ**

## ğŸ“Š æ™‚é–“çŸ­ç¸®åŠ¹æœ

| ä½œæ¥­ | å¾“æ¥ | ã“ã®ãƒ„ãƒ¼ãƒ« | å‰Šæ¸›ç‡ |
|------|------|-----------|--------|
| 10å•ã®ãƒ•ã‚©ãƒ¼ãƒ  | 30åˆ† | **3ç§’** | 99.8% |
| 50å•ã®ãƒ•ã‚©ãƒ¼ãƒ  | 150åˆ† | **10ç§’** | 99.9% |
| 100å•ã®ãƒ•ã‚©ãƒ¼ãƒ  | 300åˆ† | **20ç§’** | 99.9% |

## ğŸ¯ å¯¾å¿œè³ªå•ã‚¿ã‚¤ãƒ—

- **è¨˜è¿°å¼** (short_answer) - çŸ­æ–‡å›ç­”
- **æ®µè½** (paragraph) - é•·æ–‡å›ç­”
- **ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³** (multiple_choice) - å˜ä¸€é¸æŠ
- **ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹** (checkbox) - è¤‡æ•°é¸æŠ
- **ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³** (dropdown) - ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³
- **å‡ç­‰ç›®ç››** (linear_scale) - è©•ä¾¡ã‚¹ã‚±ãƒ¼ãƒ«
- **æ—¥ä»˜** (date) - æ—¥ä»˜é¸æŠ
- **æ™‚åˆ»** (time) - æ™‚åˆ»é¸æŠ
- **é¸æŠå¼ã‚°ãƒªãƒƒãƒ‰** (grid) - ãƒãƒˆãƒªãƒƒã‚¯ã‚¹
- **ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚°ãƒªãƒƒãƒ‰** (checkbox_grid)

---

## ğŸš€ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ï¼ˆæ‰€è¦æ™‚é–“: 30åˆ†ï¼‰

### å¿…è¦ãªã‚‚ã®
- Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
- Google Chrome
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶š

### ã‚¹ãƒ†ãƒƒãƒ—1: Google Apps Script ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆ15åˆ†ï¼‰

#### 1-1. Google Apps Scriptã‚’é–‹ã
1. ãƒ–ãƒ©ã‚¦ã‚¶ã§ https://script.google.com/home ã«ã‚¢ã‚¯ã‚»ã‚¹
2. Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³

#### 1-2. æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
1. ã€Œæ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’ã€ŒGoogleãƒ•ã‚©ãƒ¼ãƒ è‡ªå‹•ä½œæˆã€ã«å¤‰æ›´

#### 1-3. ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã‚‹
æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã‚’ã™ã¹ã¦å‰Šé™¤ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ï¼š

```javascript
/**
 * Googleãƒ•ã‚©ãƒ¼ãƒ è‡ªå‹•ä½œæˆãƒ„ãƒ¼ãƒ«
 * ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.0
 */

/**
 * Webã‚¢ãƒ—ãƒªã¨ã—ã¦å…¬é–‹ã™ã‚‹ãƒ¡ã‚¤ãƒ³é–¢æ•°
 * Chromeæ‹¡å¼µæ©Ÿèƒ½ã‹ã‚‰ã®POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚‹
 */
function doPost(e) {
  try {
    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã‹ã‚‰JSONãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    const data = JSON.parse(e.postData.contents);
    
    // Googleãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆ
    const formUrl = createGoogleForm(data);
    
    // æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™
    return ContentService
      .createTextOutput(JSON.stringify({
        success: true,
        url: formUrl,
        message: 'ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã—ã¾ã—ãŸ'
      }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    // ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™
    return ContentService
      .createTextOutput(JSON.stringify({
        success: false,
        error: error.toString(),
        message: 'ãƒ•ã‚©ãƒ¼ãƒ ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ'
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}

/**
 * Googleãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã™ã‚‹ãƒ¡ã‚¤ãƒ³é–¢æ•°
 */
function createGoogleForm(data) {
  // 1. ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆ
  const form = FormApp.create(data.formTitle);
  
  // 2. èª¬æ˜æ–‡ã‚’è¨­å®šï¼ˆã‚‚ã—ã‚ã‚Œã°ï¼‰
  if (data.formDescription) {
    form.setDescription(data.formDescription);
  }
  
  // 3. ãƒ•ã‚©ãƒ¼ãƒ ã®è¨­å®šã‚’é©ç”¨ï¼ˆã‚‚ã—ã‚ã‚Œã°ï¼‰
  if (data.settings) {
    applyFormSettings(form, data.settings);
  }
  
  // 4. è³ªå•ã‚’è¿½åŠ 
  data.questions.forEach((question, index) => {
    try {
      addQuestion(form, question);
    } catch (error) {
      throw new Error(`è³ªå•${index + 1}ã®ä½œæˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
    }
  });
  
  // 5. ãƒ•ã‚©ãƒ¼ãƒ ã®URLã‚’è¿”ã™
  return form.getPublishedUrl();
}

/**
 * ãƒ•ã‚©ãƒ¼ãƒ ã®è¨­å®šã‚’é©ç”¨
 */
function applyFormSettings(form, settings) {
  // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®åé›†
  if (settings.collectEmail !== undefined) {
    form.setCollectEmail(settings.collectEmail);
  }
  
  // å›ç­”ã®ç·¨é›†ã‚’è¨±å¯
  if (settings.allowResponseEditing !== undefined) {
    form.setAllowResponseEdits(settings.allowResponseEditing);
  }
  
  // è³ªå•ã®é †åºã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
  if (settings.shuffleQuestions !== undefined) {
    form.setShuffleQuestions(settings.shuffleQuestions);
  }
  
  // ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã«è¨­å®š
  if (settings.isQuiz !== undefined) {
    form.setIsQuiz(settings.isQuiz);
  }
  
  // ã€Œåˆ¥ã®å›ç­”ã‚’é€ä¿¡ã€ãƒªãƒ³ã‚¯ã‚’è¡¨ç¤º
  if (settings.showLinkToRespondAgain !== undefined) {
    form.setShowLinkToRespondAgain(settings.showLinkToRespondAgain);
  }
}

/**
 * è³ªå•ã‚’ãƒ•ã‚©ãƒ¼ãƒ ã«è¿½åŠ ï¼ˆã‚¿ã‚¤ãƒ—åˆ¥ï¼‰
 */
function addQuestion(form, question) {
  let item;
  
  switch (question.type) {
    // è¨˜è¿°å¼ï¼ˆçŸ­æ–‡å›ç­”ï¼‰
    case 'short_answer':
      item = form.addTextItem();
      item.setTitle(question.title);
      if (question.description) {
        item.setHelpText(question.description);
      }
      if (question.required) {
        item.setRequired(true);
      }
      break;
      
    // æ®µè½ï¼ˆé•·æ–‡å›ç­”ï¼‰
    case 'paragraph':
      item = form.addParagraphTextItem();
      item.setTitle(question.title);
      if (question.description) {
        item.setHelpText(question.description);
      }
      if (question.required) {
        item.setRequired(true);
      }
      break;
      
    // ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ï¼ˆå˜ä¸€é¸æŠï¼‰
    case 'multiple_choice':
      item = form.addMultipleChoiceItem();
      item.setTitle(question.title);
      if (question.description) {
        item.setHelpText(question.description);
      }
      if (question.required) {
        item.setRequired(true);
      }
      
      // é¸æŠè‚¢ã‚’ä½œæˆ
      const mcChoices = question.options.map(opt => item.createChoice(opt));
      item.setChoices(mcChoices);
      
      // ã€Œãã®ä»–ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³
      if (question.hasOther) {
        item.showOtherOption(true);
      }
      break;
      
    // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ï¼ˆè¤‡æ•°é¸æŠï¼‰
    case 'checkbox':
      item = form.addCheckboxItem();
      item.setTitle(question.title);
      if (question.description) {
        item.setHelpText(question.description);
      }
      if (question.required) {
        item.setRequired(true);
      }
      
      // é¸æŠè‚¢ã‚’ä½œæˆ
      const cbChoices = question.options.map(opt => item.createChoice(opt));
      item.setChoices(cbChoices);
      
      // ã€Œãã®ä»–ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³
      if (question.hasOther) {
        item.showOtherOption(true);
      }
      break;
      
    // ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ï¼ˆãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆï¼‰
    case 'dropdown':
      item = form.addListItem();
      item.setTitle(question.title);
      if (question.description) {
        item.setHelpText(question.description);
      }
      if (question.required) {
        item.setRequired(true);
      }
      
      // é¸æŠè‚¢ã‚’ä½œæˆ
      const ddChoices = question.options.map(opt => item.createChoice(opt));
      item.setChoices(ddChoices);
      break;
      
    // å‡ç­‰ç›®ç››ï¼ˆãƒªãƒƒã‚«ãƒ¼ãƒˆå°ºåº¦ï¼‰
    case 'linear_scale':
      item = form.addScaleItem();
      item.setTitle(question.title);
      if (question.description) {
        item.setHelpText(question.description);
      }
      if (question.required) {
        item.setRequired(true);
      }
      
      // ã‚¹ã‚±ãƒ¼ãƒ«ã®ç¯„å›²ã‚’è¨­å®š
      item.setBounds(
        question.scale.min || 1,
        question.scale.max || 5
      );
      
      // ãƒ©ãƒ™ãƒ«ã‚’è¨­å®š
      if (question.scale.minLabel && question.scale.maxLabel) {
        item.setLabels(question.scale.minLabel, question.scale.maxLabel);
      }
      break;
      
    // æ—¥ä»˜
    case 'date':
      item = form.addDateItem();
      item.setTitle(question.title);
      if (question.description) {
        item.setHelpText(question.description);
      }
      if (question.required) {
        item.setRequired(true);
      }
      
      // å¹´ã‚’å«ã‚ã‚‹ã‹ã©ã†ã‹
      if (question.includeYear === false) {
        item.setIncludesYear(false);
      }
      break;
      
    // æ™‚åˆ»
    case 'time':
      item = form.addTimeItem();
      item.setTitle(question.title);
      if (question.description) {
        item.setHelpText(question.description);
      }
      if (question.required) {
        item.setRequired(true);
      }
      break;
      
    // é¸æŠå¼ã‚°ãƒªãƒƒãƒ‰ï¼ˆãƒãƒˆãƒªãƒƒã‚¯ã‚¹ï¼‰
    case 'grid':
      item = form.addGridItem();
      item.setTitle(question.title);
      if (question.description) {
        item.setHelpText(question.description);
      }
      if (question.required) {
        item.setRequired(true);
      }
      
      // è¡Œã¨åˆ—ã‚’è¨­å®š
      item.setRows(question.rows);
      item.setColumns(question.columns);
      break;
      
    // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚°ãƒªãƒƒãƒ‰
    case 'checkbox_grid':
      item = form.addCheckboxGridItem();
      item.setTitle(question.title);
      if (question.description) {
        item.setHelpText(question.description);
      }
      if (question.required) {
        item.setRequired(true);
      }
      
      // è¡Œã¨åˆ—ã‚’è¨­å®š
      item.setRows(question.rows);
      item.setColumns(question.columns);
      break;
      
    default:
      throw new Error(`æœªå¯¾å¿œã®è³ªå•ã‚¿ã‚¤ãƒ—: ${question.type}`);
  }
}

/**
 * ãƒ†ã‚¹ãƒˆç”¨é–¢æ•°
 * ã“ã®é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã‚µãƒ³ãƒ—ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ãŒä½œæˆã•ã‚Œã¾ã™
 */
function testCreateForm() {
  const testData = {
    "formTitle": "ãƒ†ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ãƒ  - è‡ªå‹•ä½œæˆ",
    "formDescription": "ã“ã®ãƒ•ã‚©ãƒ¼ãƒ ã¯è‡ªå‹•ä½œæˆãƒ„ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆã§ã™",
    "settings": {
      "collectEmail": false,
      "allowResponseEditing": true
    },
    "questions": [
      {
        "id": "q1",
        "type": "short_answer",
        "title": "ãŠåå‰ã‚’æ•™ãˆã¦ãã ã•ã„",
        "description": "ãƒ•ãƒ«ãƒãƒ¼ãƒ ã§å…¥åŠ›ã—ã¦ãã ã•ã„",
        "required": true
      },
      {
        "id": "q2",
        "type": "multiple_choice",
        "title": "å¹´é½¢å±¤ã‚’é¸æŠã—ã¦ãã ã•ã„",
        "required": true,
        "options": ["10ä»£", "20ä»£", "30ä»£", "40ä»£", "50ä»£ä»¥ä¸Š"]
      },
      {
        "id": "q3",
        "type": "checkbox",
        "title": "èˆˆå‘³ã®ã‚ã‚‹åˆ†é‡ã‚’é¸ã‚“ã§ãã ã•ã„ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰",
        "required": false,
        "options": ["ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼", "ãƒ“ã‚¸ãƒã‚¹", "ãƒ‡ã‚¶ã‚¤ãƒ³", "æ•™è‚²", "ãã®ä»–"]
      },
      {
        "id": "q4",
        "type": "linear_scale",
        "title": "æº€è¶³åº¦ã‚’æ•™ãˆã¦ãã ã•ã„",
        "required": true,
        "scale": {
          "min": 1,
          "max": 5,
          "minLabel": "ä¸æº€",
          "maxLabel": "æº€è¶³"
        }
      }
    ]
  };
  
  try {
    const url = createGoogleForm(testData);
    Logger.log('âœ… ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆæˆåŠŸï¼');
    Logger.log('URL: ' + url);
    return url;
  } catch (error) {
    Logger.log('âŒ ã‚¨ãƒ©ãƒ¼: ' + error.toString());
    throw error;
  }
}
```

#### 1-4. å‹•ä½œãƒ†ã‚¹ãƒˆ
1. é–¢æ•°é¸æŠã§ã€ŒtestCreateFormã€ã‚’é¸æŠ
2. ã€Œå®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. æ¨©é™æ‰¿èªã‚’è¡Œã†ï¼ˆåˆå›ã®ã¿ï¼‰
4. å®Ÿè¡Œãƒ­ã‚°ã§æˆåŠŸã‚’ç¢ºèª

#### 1-5. Webã‚¢ãƒ—ãƒªã¨ã—ã¦å…¬é–‹
1. ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ç¨®é¡ã‚’ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã«è¨­å®š
3. å®Ÿè¡Œãƒ¦ãƒ¼ã‚¶ãƒ¼: ã€Œè‡ªåˆ†ã€
4. ã‚¢ã‚¯ã‚»ã‚¹: ã€Œå…¨å“¡ã€
5. ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä¿å­˜

### ã‚¹ãƒ†ãƒƒãƒ—2: Chromeæ‹¡å¼µæ©Ÿèƒ½ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆ10åˆ†ï¼‰

#### 2-1. ãƒ•ã‚¡ã‚¤ãƒ«æº–å‚™
ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã‚’ä½œæˆï¼š

```
google-form-generator/
â”œâ”€â”€ manifest.json
â”œâ”€â”€ popup.html
â”œâ”€â”€ popup.js
â””â”€â”€ icons/
    â”œâ”€â”€ icon16.png
    â”œâ”€â”€ icon48.png
    â””â”€â”€ icon128.png
```

#### 2-2. manifest.json ã®ä½œæˆ
```json
{
  "manifest_version": 3,
  "name": "Google Form Generator",
  "version": "1.0.0",
  "description": "JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰Googleãƒ•ã‚©ãƒ¼ãƒ ã‚’è‡ªå‹•ä½œæˆ",
  "permissions": [
    "storage"
  ],
  "action": {
    "default_popup": "popup.html",
    "default_icon": {
      "16": "icons/icon16.png",
      "48": "icons/icon48.png",
      "128": "icons/icon128.png"
    }
  },
  "icons": {
    "16": "icons/icon16.png",
    "48": "icons/icon48.png",
    "128": "icons/icon128.png"
  }
}
```

#### 2-3. popup.html ã®ä½œæˆ
```html
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Google Form Generator</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      width: 500px;
      min-height: 400px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f5f5;
    }

    .container {
      padding: 20px;
      max-height: 600px;
      overflow-y: auto;
    }

    h1 {
      font-size: 24px;
      color: #1a73e8;
      margin-bottom: 20px;
      text-align: center;
    }

    h2 {
      font-size: 16px;
      color: #333;
      margin-bottom: 10px;
    }

    .section {
      background: white;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .form-group {
      margin-bottom: 10px;
    }

    label {
      display: block;
      font-size: 14px;
      color: #555;
      margin-bottom: 5px;
      font-weight: 500;
    }

    input[type="text"] {
      width: 100%;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
      transition: border-color 0.3s;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: #1a73e8;
    }

    input[type="file"] {
      width: 100%;
      padding: 8px;
      border: 2px dashed #ddd;
      border-radius: 4px;
      font-size: 14px;
      cursor: pointer;
      background: #fafafa;
    }

    input[type="file"]:hover {
      border-color: #1a73e8;
      background: #f0f7ff;
    }

    button {
      padding: 10px 18px;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 500;
    }

    button:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }

    button:active:not(:disabled) {
      transform: translateY(0);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .primary-button {
      width: 100%;
      background: #1a73e8;
      color: white;
      padding: 14px;
      font-size: 16px;
      font-weight: bold;
    }

    .primary-button:hover:not(:disabled) {
      background: #1557b0;
    }

    .save-button {
      background: #34a853;
      color: white;
      margin-top: 8px;
      width: 100%;
    }

    .save-button:hover:not(:disabled) {
      background: #2d8e47;
    }

    .help-text {
      font-size: 12px;
      color: #666;
      margin-top: 8px;
      line-height: 1.5;
    }

    .file-info {
      margin-top: 12px;
      padding: 12px;
      background: linear-gradient(135deg, #e8f0fe 0%, #f0f7ff 100%);
      border-radius: 4px;
      border-left: 4px solid #1a73e8;
      font-size: 13px;
      line-height: 1.6;
      display: none;
    }

    .preview {
      max-height: 300px;
      overflow-y: auto;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      padding: 10px;
    }

    .preview-title {
      font-size: 18px;
      font-weight: bold;
      color: #333;
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 2px solid #1a73e8;
    }

    .preview-description {
      font-size: 14px;
      color: #666;
      margin-bottom: 15px;
      font-style: italic;
    }

    .preview-question {
      padding: 12px;
      border-left: 3px solid #1a73e8;
      margin-bottom: 12px;
      background: #fafafa;
      border-radius: 4px;
    }

    .question-number {
      font-size: 11px;
      color: #666;
      text-transform: uppercase;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .question-title {
      font-size: 14px;
      font-weight: 500;
      color: #333;
      margin: 5px 0;
    }

    .required {
      color: #d93025;
      margin-left: 3px;
      font-weight: bold;
    }

    .question-description {
      font-size: 12px;
      color: #666;
      margin: 5px 0;
      font-style: italic;
    }

    .question-type {
      font-size: 11px;
      color: #1a73e8;
      margin-top: 5px;
      background: #e8f0fe;
      display: inline-block;
      padding: 2px 8px;
      border-radius: 3px;
    }

    .result {
      text-align: center;
    }

    .form-link {
      display: block;
      margin: 15px 0;
      padding: 12px;
      background: #e8f0fe;
      border-radius: 6px;
      color: #1a73e8;
      text-decoration: none;
      word-break: break-all;
      font-size: 13px;
      border: 2px solid #1a73e8;
      transition: all 0.3s;
    }

    .form-link:hover {
      background: #d2e3fc;
      transform: scale(1.02);
    }

    .error-section {
      background: #fce8e6;
      border-left: 4px solid #d93025;
    }

    .error {
      color: #d93025;
      font-size: 14px;
      line-height: 1.5;
    }

    .status {
      text-align: center;
      padding: 12px;
      border-radius: 4px;
      font-size: 14px;
      margin-top: 10px;
      font-weight: 500;
      animation: fadeIn 0.3s;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .status.success {
      background: #e6f4ea;
      color: #1e8e3e;
      border: 1px solid #1e8e3e;
    }

    .status.error {
      background: #fce8e6;
      color: #d93025;
      border: 1px solid #d93025;
    }

    .status.info {
      background: #e8f0fe;
      color: #1a73e8;
      border: 1px solid #1a73e8;
    }

    .loading {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* URLè¡¨ç¤ºã‚¹ã‚¿ã‚¤ãƒ« */
    .url-display {
      background: linear-gradient(135deg, #e8f0fe 0%, #f0f7ff 100%);
      border: 2px solid #1a73e8;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
    }

    .url-display-content {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .url-label {
      font-size: 14px;
      font-weight: 600;
      color: #1e8e3e;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .url-preview {
      font-size: 12px;
      color: #666;
      font-family: monospace;
      background: rgba(255,255,255,0.8);
      padding: 8px 10px;
      border-radius: 4px;
      border: 1px solid #ddd;
    }

    .edit-url-button {
      width: 100%;
      background: #f8f9fa;
      color: #333;
      border: 2px solid #dadce0;
      margin-bottom: 15px;
      font-size: 13px;
    }

    .edit-url-button:hover:not(:disabled) {
      background: #e8f0fe;
      border-color: #1a73e8;
      color: #1a73e8;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“ Google Form Generator</h1>
    
    <!-- è¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="section" id="settingsSection">
      <h2>âš™ï¸ è¨­å®š</h2>
      
      <!-- URLè¡¨ç¤ºï¼ˆæŠ˜ã‚ŠãŸãŸã¿çŠ¶æ…‹ï¼‰ -->
      <div id="urlDisplay" class="url-display" style="display: none;">
        <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ -->
      </div>
      
      <!-- URLç·¨é›†ï¼ˆå±•é–‹çŠ¶æ…‹ï¼‰ -->
      <div class="form-group" id="urlEditGroup">
        <label for="apiUrl">Apps Script URL:</label>
        <input type="text" id="apiUrl" placeholder="https://script.google.com/macros/s/.../exec">
        <button class="save-button" id="saveSettings">ğŸ’¾ ä¿å­˜</button>
      </div>
      
      <!-- ç·¨é›†ãƒœã‚¿ãƒ³ï¼ˆæŠ˜ã‚ŠãŸãŸã¿çŠ¶æ…‹ï¼‰ -->
      <button class="edit-url-button" id="toggleUrlEdit" style="display: none;">
        âœï¸ URLè¨­å®šã‚’å¤‰æ›´
      </button>
      
      <p class="help-text">
        Google Apps Scriptã®ãƒ‡ãƒ—ãƒ­ã‚¤URLã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚<br>
        URLã¯ã€Œhttps://script.google.com/macros/s/ã€ã§å§‹ã¾ã‚Šã¾ã™ã€‚
      </p>
    </div>
    
    <!-- ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="section">
      <h2>ğŸ“ JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</h2>
      <input type="file" id="fileInput" accept=".json">
      <div id="fileInfo" class="file-info"></div>
    </div>
    
    <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="section" id="previewSection" style="display: none;">
      <h2>ğŸ‘€ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
      <div id="preview" class="preview"></div>
    </div>
    
    <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
    <div class="section">
      <button id="createForm" class="primary-button" disabled>
        ğŸš€ ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆ
      </button>
    </div>
    
    <!-- çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="section" id="resultSection" style="display: none;">
      <h2>âœ… ä½œæˆå®Œäº†</h2>
      <div id="result" class="result"></div>
    </div>
    
    <!-- ã‚¨ãƒ©ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="section error-section" id="errorSection" style="display: none;">
      <h2>âŒ ã‚¨ãƒ©ãƒ¼</h2>
      <div id="error" class="error"></div>
    </div>
    
    <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
    <div id="status" class="status"></div>
  </div>
  
  <script src="popup.js"></script>
</body>
</html>
```

#### 2-4. popup.js ã®ä½œæˆ
```javascript
// ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
let formData = null;
let apiUrl = '';

// åˆæœŸåŒ–
document.addEventListener('DOMContentLoaded', async () => {
  console.log('Google Form Generator èµ·å‹•');
  
  // ä¿å­˜æ¸ˆã¿ã®è¨­å®šã‚’èª­ã¿è¾¼ã‚€
  const result = await chrome.storage.local.get(['apiUrl']);
  if (result.apiUrl) {
    apiUrl = result.apiUrl;
    document.getElementById('apiUrl').value = apiUrl;
    console.log('ä¿å­˜æ¸ˆã¿URLèª­ã¿è¾¼ã¿å®Œäº†');
    // URLãŒè¨­å®šæ¸ˆã¿ã®å ´åˆã¯æŠ˜ã‚ŠãŸãŸã¿è¡¨ç¤ºã«ã™ã‚‹
    toggleUrlSection(true);
  }
  
  setupEventListeners();
});

// ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
function setupEventListeners() {
  document.getElementById('saveSettings').addEventListener('click', saveSettings);
  document.getElementById('fileInput').addEventListener('change', handleFileSelect);
  document.getElementById('createForm').addEventListener('click', createForm);
  
  // URLç·¨é›†ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆã®ã¿ï¼‰
  const toggleButton = document.getElementById('toggleUrlEdit');
  if (toggleButton) {
    toggleButton.addEventListener('click', toggleUrlEdit);
  }
}

// URLè¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
function toggleUrlSection(isCollapsed) {
  const urlInput = document.getElementById('apiUrl');
  const saveButton = document.getElementById('saveSettings');
  const urlEditButton = document.getElementById('toggleUrlEdit');
  const helpText = document.querySelector('#settingsSection .help-text');
  const urlDisplay = document.getElementById('urlDisplay');
  
  if (isCollapsed) {
    // æŠ˜ã‚ŠãŸãŸã¿è¡¨ç¤ºï¼ˆURLãŒè¨­å®šæ¸ˆã¿çŠ¶æ…‹ï¼‰
    urlInput.style.display = 'none';
    saveButton.style.display = 'none';
    helpText.style.display = 'none';
    urlDisplay.style.display = 'block';
    urlEditButton.style.display = 'block';
    urlDisplay.innerHTML = `
      <div class="url-display-content">
        <span class="url-label">âœ… Apps Script URLè¨­å®šæ¸ˆã¿</span>
        <span class="url-preview">${apiUrl.substring(0, 50)}...</span>
      </div>
    `;
  } else {
    // ç·¨é›†è¡¨ç¤º
    urlInput.style.display = 'block';
    saveButton.style.display = 'block';
    helpText.style.display = 'block';
    urlDisplay.style.display = 'none';
    urlEditButton.style.display = 'none';
  }
}

// URLç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆ
function toggleUrlEdit() {
  toggleUrlSection(false);
  // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
  setTimeout(() => {
    document.getElementById('apiUrl').focus();
  }, 100);
}

// è¨­å®šã‚’ä¿å­˜
async function saveSettings() {
  const url = document.getElementById('apiUrl').value.trim();
  
  if (!url) {
    showError('URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
    return;
  }
  
  if (!url.startsWith('https://script.google.com/macros/s/')) {
    showError('æ­£ã—ã„Google Apps Script URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\nURLã¯ "https://script.google.com/macros/s/" ã§å§‹ã¾ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™');
    return;
  }
  
  if (!url.endsWith('/exec')) {
    showError('URLã®æœ«å°¾ãŒ "/exec" ã§çµ‚ã‚ã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„');
    return;
  }
  
  apiUrl = url;
  await chrome.storage.local.set({ apiUrl: url });
  showStatus('âœ… è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'success');
  console.log('URLä¿å­˜:', url);
  
  // ä¿å­˜å¾Œã«æŠ˜ã‚ŠãŸãŸã¿è¡¨ç¤ºã«åˆ‡ã‚Šæ›¿ãˆ
  toggleUrlSection(true);
}

// ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠå‡¦ç†
function handleFileSelect(event) {
  const file = event.target.files[0];
  
  if (!file) {
    return;
  }
  
  console.log('ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ:', file.name);
  
  if (!file.name.endsWith('.json')) {
    showError('JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ï¼ˆæ‹¡å¼µå­ãŒ .json ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰');
    return;
  }
  
  const reader = new FileReader();
  
  reader.onload = (e) => {
    try {
      formData = JSON.parse(e.target.result);
      console.log('JSONè§£ææˆåŠŸ:', formData);
      
      validateFormData(formData);
      displayFileInfo(file, formData);
      displayPreview(formData);
      document.getElementById('createForm').disabled = false;
      hideError();
      
      showStatus('âœ… ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ', 'success');
    } catch (error) {
      console.error('ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
      showError(`ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:\n${error.message}\n\nJSONãƒ•ã‚¡ã‚¤ãƒ«ã®å½¢å¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„`);
      formData = null;
      document.getElementById('createForm').disabled = true;
    }
  };
  
  reader.onerror = () => {
    showError('ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
  };
  
  reader.readAsText(file);
}

// ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
function validateFormData(data) {
  if (!data.formTitle) {
    throw new Error('formTitleï¼ˆãƒ•ã‚©ãƒ¼ãƒ ã‚¿ã‚¤ãƒˆãƒ«ï¼‰ãŒå¿…è¦ã§ã™');
  }
  
  if (!data.questions || !Array.isArray(data.questions)) {
    throw new Error('questionsï¼ˆè³ªå•ã®é…åˆ—ï¼‰ãŒå¿…è¦ã§ã™');
  }
  
  if (data.questions.length === 0) {
    throw new Error('å°‘ãªãã¨ã‚‚1ã¤ã®è³ªå•ãŒå¿…è¦ã§ã™');
  }
  
  // å¯¾å¿œã™ã‚‹è³ªå•ã‚¿ã‚¤ãƒ—
  const validTypes = [
    'short_answer', 'paragraph', 'multiple_choice', 'checkbox',
    'dropdown', 'linear_scale', 'date', 'time', 'grid', 'checkbox_grid'
  ];
  
  // å„è³ªå•ã®æ¤œè¨¼
  data.questions.forEach((q, index) => {
    if (!q.type) {
      throw new Error(`è³ªå•${index + 1}: typeï¼ˆè³ªå•ã‚¿ã‚¤ãƒ—ï¼‰ãŒå¿…è¦ã§ã™`);
    }
    if (!validTypes.includes(q.type)) {
      throw new Error(`è³ªå•${index + 1}: ç„¡åŠ¹ãªè³ªå•ã‚¿ã‚¤ãƒ— "${q.type}"\nå¯¾å¿œã‚¿ã‚¤ãƒ—: ${validTypes.join(', ')}`);
    }
    if (!q.title) {
      throw new Error(`è³ªå•${index + 1}: titleï¼ˆè³ªå•æ–‡ï¼‰ãŒå¿…è¦ã§ã™`);
    }
    
    // é¸æŠè‚¢ãŒå¿…è¦ãªã‚¿ã‚¤ãƒ—ã®æ¤œè¨¼
    if (['multiple_choice', 'checkbox', 'dropdown'].includes(q.type)) {
      if (!q.options || !Array.isArray(q.options) || q.options.length === 0) {
        throw new Error(`è³ªå•${index + 1}: optionsï¼ˆé¸æŠè‚¢ã®é…åˆ—ï¼‰ãŒå¿…è¦ã§ã™`);
      }
    }
    
    // ã‚¹ã‚±ãƒ¼ãƒ«ã‚¿ã‚¤ãƒ—ã®æ¤œè¨¼
    if (q.type === 'linear_scale') {
      if (!q.scale || !q.scale.min || !q.scale.max) {
        throw new Error(`è³ªå•${index + 1}: scale.min ã¨ scale.max ãŒå¿…è¦ã§ã™`);
      }
    }
    
    // ã‚°ãƒªãƒƒãƒ‰ã‚¿ã‚¤ãƒ—ã®æ¤œè¨¼
    if (['grid', 'checkbox_grid'].includes(q.type)) {
      if (!q.rows || !Array.isArray(q.rows) || q.rows.length === 0) {
        throw new Error(`è³ªå•${index + 1}: rowsï¼ˆè¡Œã®é…åˆ—ï¼‰ãŒå¿…è¦ã§ã™`);
      }
      if (!q.columns || !Array.isArray(q.columns) || q.columns.length === 0) {
        throw new Error(`è³ªå•${index + 1}: columnsï¼ˆåˆ—ã®é…åˆ—ï¼‰ãŒå¿…è¦ã§ã™`);
      }
    }
  });
  
  console.log('ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ');
}

// ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±ã‚’è¡¨ç¤º
function displayFileInfo(file, data) {
  const info = document.getElementById('fileInfo');
  info.innerHTML = `
    <strong>ğŸ“„ ${file.name}</strong> (${(file.size / 1024).toFixed(2)} KB)<br>
    <strong>ğŸ“ ãƒ•ã‚©ãƒ¼ãƒ ã‚¿ã‚¤ãƒˆãƒ«:</strong> ${data.formTitle}<br>
    <strong>â“ è³ªå•æ•°:</strong> ${data.questions.length}å•
  `;
  info.style.display = 'block';
}

// ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤º
function displayPreview(data) {
  const preview = document.getElementById('preview');
  const previewSection = document.getElementById('previewSection');
  
  let html = `
    <div class="preview-title">${data.formTitle}</div>
    ${data.formDescription ? `<div class="preview-description">${data.formDescription}</div>` : ''}
    <div class="preview-questions">
  `;
  
  data.questions.forEach((q, index) => {
    html += `
      <div class="preview-question">
        <div class="question-number">è³ªå• ${index + 1}</div>
        <div class="question-title">
          ${q.title}
          ${q.required ? '<span class="required">*</span>' : ''}
        </div>
        ${q.description ? `<div class="question-description">${q.description}</div>` : ''}
        <div class="question-type">${getTypeLabel(q.type)}</div>
      </div>
    `;
  });
  
  html += '</div>';
  preview.innerHTML = html;
  previewSection.style.display = 'block';
}

// è³ªå•ã‚¿ã‚¤ãƒ—ã®ãƒ©ãƒ™ãƒ«ï¼ˆæ—¥æœ¬èªï¼‰
function getTypeLabel(type) {
  const labels = {
    'short_answer': 'è¨˜è¿°å¼ï¼ˆçŸ­æ–‡ï¼‰',
    'paragraph': 'æ®µè½ï¼ˆé•·æ–‡ï¼‰',
    'multiple_choice': 'ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ï¼ˆå˜ä¸€é¸æŠï¼‰',
    'checkbox': 'ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ï¼ˆè¤‡æ•°é¸æŠï¼‰',
    'dropdown': 'ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³',
    'linear_scale': 'å‡ç­‰ç›®ç››ï¼ˆè©•ä¾¡ï¼‰',
    'date': 'æ—¥ä»˜',
    'time': 'æ™‚åˆ»',
    'grid': 'é¸æŠå¼ã‚°ãƒªãƒƒãƒ‰',
    'checkbox_grid': 'ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚°ãƒªãƒƒãƒ‰'
  };
  return labels[type] || type;
}

// ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆ
async function createForm() {
  console.log('ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆé–‹å§‹');
  
  if (!apiUrl) {
    showError('Apps Script URLã‚’è¨­å®šã—ã¦ãã ã•ã„');
    return;
  }
  
  if (!formData) {
    showError('JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„');
    return;
  }
  
  // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
  const button = document.getElementById('createForm');
  const originalText = button.innerHTML;
  button.disabled = true;
  button.innerHTML = '<span class="loading"></span> ä½œæˆä¸­...';
  
  showStatus('ğŸ“¤ ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã—ã¦ã„ã¾ã™...', 'info');
  hideError();
  hideResult();
  
  try {
    console.log('APIå‘¼ã³å‡ºã—:', apiUrl);
    console.log('é€ä¿¡ãƒ‡ãƒ¼ã‚¿:', formData);
    
    const response = await fetch(apiUrl, {
      method: 'POST',
      mode: 'no-cors',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(formData)
    });
    
    console.log('ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡å®Œäº†');
    
    // å°‘ã—å¾…ã£ã¦ã‹ã‚‰æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
    setTimeout(() => {
      showStatus('âœ… ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¾ã—ãŸï¼\nGoogle Driveã‚’ç¢ºèªã—ã¦ãã ã•ã„', 'success');
      showResult('ä½œæˆå®Œäº†');
    }, 2000);
    
  } catch (error) {
    console.error('ä½œæˆã‚¨ãƒ©ãƒ¼:', error);
    showError(`ä½œæˆã‚¨ãƒ©ãƒ¼:\n${error.message}\n\nURLã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„`);
    showStatus('', '');
  } finally {
    button.disabled = false;
    button.innerHTML = originalText;
  }
}

// çµæœã‚’è¡¨ç¤º
function showResult(message) {
  const result = document.getElementById('result');
  const resultSection = document.getElementById('resultSection');
  
  result.innerHTML = `
    <p>ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¾ã—ãŸï¼</p>
    <p style="margin-top: 10px; font-size: 14px; color: #666;">
      Google Driveã‚’é–‹ã„ã¦ã€ä½œæˆã•ã‚ŒãŸãƒ•ã‚©ãƒ¼ãƒ ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚<br>
      æ•°ç§’å¾Œã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
    </p>
    <a href="https://drive.google.com/drive/my-drive" target="_blank" class="form-link">
      ğŸ“ Google Driveã‚’é–‹ã
    </a>
  `;
  resultSection.style.display = 'block';
}

// ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
function showError(message) {
  const error = document.getElementById('error');
  const errorSection = document.getElementById('errorSection');
  error.textContent = message;
  errorSection.style.display = 'block';
  console.error('ã‚¨ãƒ©ãƒ¼:', message);
}

function hideError() {
  document.getElementById('errorSection').style.display = 'none';
}

// çµæœã‚’éè¡¨ç¤º
function hideResult() {
  document.getElementById('resultSection').style.display = 'none';
}

// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
function showStatus(message, type) {
  const status = document.getElementById('status');
  status.textContent = message;
  status.className = `status ${type}`;
  
  if (message && type === 'success') {
    setTimeout(() => {
      status.textContent = '';
      status.className = 'status';
    }, 5000);
  }
}
```

#### 2-5. ã‚¢ã‚¤ã‚³ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ
1. Canvaã§128Ã—128ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½œæˆï¼ˆèƒŒæ™¯: é’ #1a73e8ã€æ–‡å­—: ç™½ã€ŒGã€ï¼‰
2. 48Ã—48ã¨16Ã—16ã«ãƒªã‚µã‚¤ã‚º
3. `icons/`ãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜

#### 2-6. Chromeæ‹¡å¼µæ©Ÿèƒ½ã‚’èª­ã¿è¾¼ã‚€
1. Chromeã§ `chrome://extensions/` ã‚’é–‹ã
2. ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã‚’ONã«ã™ã‚‹
3. ã€Œãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã•ã‚Œã¦ã„ãªã„æ‹¡å¼µæ©Ÿèƒ½ã‚’èª­ã¿è¾¼ã‚€ã€ã§ãƒ•ã‚©ãƒ«ãƒ€ã‚’é¸æŠ
4. æ‹¡å¼µæ©Ÿèƒ½ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’é–‹ã„ã¦ã€Apps Script URLã‚’è¨­å®š

### ã‚¹ãƒ†ãƒƒãƒ—3: å‹•ä½œç¢ºèªï¼ˆ5åˆ†ï¼‰

1. ã‚µãƒ³ãƒ—ãƒ«JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãƒ†ã‚¹ãƒˆ
2. ãƒ•ã‚©ãƒ¼ãƒ ãŒGoogle Driveã«ä½œæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

---

## ğŸ¤– ChatGPTé€£æºæ–¹æ³•

### ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
```
ä»¥ä¸‹ã®JSONå½¢å¼ã§ã€Googleãƒ•ã‚©ãƒ¼ãƒ ã®è³ªå•ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚

ã€ãƒ•ã‚©ãƒ¼ãƒ ã®ç›®çš„ã€‘
ï¼ˆã“ã“ã«ãƒ•ã‚©ãƒ¼ãƒ ã®ç›®çš„ã‚’è¨˜è¿°ï¼‰

ã€å¯¾è±¡è€…ã€‘
ï¼ˆèª°ãŒå›ç­”ã™ã‚‹ã‹ï¼‰

ã€è³ªå•æ•°ã€‘
ï¼ˆä½•å•ä½œæˆã™ã‚‹ã‹ï¼‰

ã€å¿…é ˆã®JSONå½¢å¼ã€‘
{
  "formTitle": "ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚¿ã‚¤ãƒˆãƒ«",
  "formDescription": "ãƒ•ã‚©ãƒ¼ãƒ ã®èª¬æ˜æ–‡",
  "settings": {
    "collectEmail": false,
    "allowResponseEditing": true,
    "shuffleQuestions": false
  },
  "questions": [
    {
      "id": "q1",
      "type": "è³ªå•ã‚¿ã‚¤ãƒ—",
      "title": "è³ªå•æ–‡",
      "description": "è³ªå•ã®èª¬æ˜ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰",
      "required": true/false,
      ï¼ˆã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸè¿½åŠ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰
    }
  ]
}

ã€å¯¾å¿œã™ã‚‹è³ªå•ã‚¿ã‚¤ãƒ—ã€‘
- short_answer: çŸ­æ–‡å›ç­”
- paragraph: é•·æ–‡å›ç­”
- multiple_choice: å˜ä¸€é¸æŠï¼ˆãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ï¼‰ã€optionsé…åˆ—ãŒå¿…è¦
- checkbox: è¤‡æ•°é¸æŠã€optionsé…åˆ—ãŒå¿…è¦
- dropdown: ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã€optionsé…åˆ—ãŒå¿…è¦
- linear_scale: è©•ä¾¡ã‚¹ã‚±ãƒ¼ãƒ«ã€scaleã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆmin, max, minLabel, maxLabelï¼‰ãŒå¿…è¦
- date: æ—¥ä»˜
- time: æ™‚åˆ»
- grid: é¸æŠå¼ã‚°ãƒªãƒƒãƒ‰ã€rowsã¨columnsé…åˆ—ãŒå¿…è¦
- checkbox_grid: ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚°ãƒªãƒƒãƒ‰ã€rowsã¨columnsé…åˆ—ãŒå¿…è¦

ã€æ³¨æ„äº‹é …ã€‘
- JSONã®ã¿ã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ï¼ˆèª¬æ˜æ–‡ã¯ä¸è¦ï¼‰
- ã™ã¹ã¦ã®ã‚­ãƒ¼ã¯ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§å›²ã‚€
- æ—¥æœ¬èªã®è³ªå•æ–‡ã‚’ä½¿ç”¨
- è«–ç†çš„ãªè³ªå•ã®é †åºã§æ§‹æˆ
```

### ä½¿ç”¨ä¾‹
```
ä»¥ä¸‹ã®JSONå½¢å¼ã§ã€é¡§å®¢æº€è¶³åº¦ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ã€ãƒ•ã‚©ãƒ¼ãƒ ã®ç›®çš„ã€‘
ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨å¾Œã®é¡§å®¢æº€è¶³åº¦ã‚’æ¸¬å®š

ã€å¯¾è±¡è€…ã€‘
å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã—ãŸé¡§å®¢

ã€è³ªå•æ•°ã€‘
8-10å•

ã€è³ªå•å†…å®¹ã®è¦ä»¶ã€‘
- åŸºæœ¬æƒ…å ±ï¼ˆåå‰ã€å¹´é½¢å±¤ï¼‰
- ã‚µãƒ¼ãƒ“ã‚¹æº€è¶³åº¦ï¼ˆ1-5ã‚¹ã‚±ãƒ¼ãƒ«ï¼‰
- æ”¹å–„ç‚¹ï¼ˆè‡ªç”±è¨˜è¿°ï¼‰
- æ¨å¥¨æ„å‘ï¼ˆNPSï¼‰
- å†åˆ©ç”¨æ„å‘

JSONã®ã¿ã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚
```

---

## ğŸ“‹ ã‚µãƒ³ãƒ—ãƒ«JSONãƒ•ã‚¡ã‚¤ãƒ«

```json
{
  "formTitle": "é¡§å®¢æº€è¶³åº¦ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ",
  "formDescription": "ã‚µãƒ¼ãƒ“ã‚¹ã«é–¢ã™ã‚‹ã”æ„è¦‹ã‚’ãŠèã‹ã›ãã ã•ã„ã€‚æ‰€è¦æ™‚é–“ï¼šç´„3åˆ†",
  "settings": {
    "collectEmail": false,
    "allowResponseEditing": true,
    "shuffleQuestions": false
  },
  "questions": [
    {
      "id": "q1",
      "type": "short_answer",
      "title": "ãŠåå‰ã‚’æ•™ãˆã¦ãã ã•ã„",
      "description": "ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã§ã‚‚æ§‹ã„ã¾ã›ã‚“",
      "required": true
    },
    {
      "id": "q2",
      "type": "multiple_choice",
      "title": "å¹´é½¢å±¤ã‚’é¸æŠã—ã¦ãã ã•ã„",
      "required": true,
      "options": [
        "10ä»£",
        "20ä»£",
        "30ä»£",
        "40ä»£",
        "50ä»£",
        "60ä»£ä»¥ä¸Š"
      ]
    },
    {
      "id": "q3",
      "type": "checkbox",
      "title": "èˆˆå‘³ã®ã‚ã‚‹åˆ†é‡ã‚’é¸ã‚“ã§ãã ã•ã„ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰",
      "description": "æœ€ã‚‚é–¢å¿ƒã®ã‚ã‚‹ã‚‚ã®ã‚’é¸æŠã—ã¦ãã ã•ã„",
      "required": false,
      "options": [
        "ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼",
        "ãƒ“ã‚¸ãƒã‚¹",
        "ãƒ‡ã‚¶ã‚¤ãƒ³",
        "ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°",
        "æ•™è‚²",
        "ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆ"
      ],
      "hasOther": true
    },
    {
      "id": "q4",
      "type": "linear_scale",
      "title": "ã‚µãƒ¼ãƒ“ã‚¹ã®æº€è¶³åº¦ã‚’æ•™ãˆã¦ãã ã•ã„",
      "required": true,
      "scale": {
        "min": 1,
        "max": 5,
        "minLabel": "éå¸¸ã«ä¸æº€",
        "maxLabel": "éå¸¸ã«æº€è¶³"
      }
    },
    {
      "id": "q5",
      "type": "dropdown",
      "title": "ã©ã®ã‚ˆã†ã«ã—ã¦å½“ã‚µãƒ¼ãƒ“ã‚¹ã‚’çŸ¥ã‚Šã¾ã—ãŸã‹ï¼Ÿ",
      "required": true,
      "options": [
        "ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¤œç´¢",
        "SNS",
        "å‹äººãƒ»çŸ¥äººã®ç´¹ä»‹",
        "åºƒå‘Š",
        "ãã®ä»–"
      ]
    },
    {
      "id": "q6",
      "type": "paragraph",
      "title": "ã”æ„è¦‹ãƒ»ã”è¦æœ›ãŒã‚ã‚Šã¾ã—ãŸã‚‰è‡ªç”±ã«ã”è¨˜å…¥ãã ã•ã„",
      "description": "ã‚µãƒ¼ãƒ“ã‚¹æ”¹å–„ã®å‚è€ƒã«ã•ã›ã¦ã„ãŸã ãã¾ã™",
      "required": false
    }
  ]
}
```

---

## ğŸ’¡ åŸºæœ¬çš„ãªä½¿ã„æ–¹

### 1. ChatGPTã§JSONã‚’ç”Ÿæˆ
```
ã€Œé¡§å®¢æº€è¶³åº¦ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã‚’10å•ã§ä½œæˆã—ã¦ãã ã•ã„ã€
```

### 2. JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜
- ç”Ÿæˆã•ã‚ŒãŸJSONã‚’ `.json` ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜

### 3. Chromeæ‹¡å¼µæ©Ÿèƒ½ã§ä½œæˆ
- æ‹¡å¼µæ©Ÿèƒ½ã‚’é–‹ã
- JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
- ã€Œãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯

### 4. å®Œæˆï¼
- Google Driveã«ãƒ•ã‚©ãƒ¼ãƒ ãŒä½œæˆã•ã‚Œã‚‹

---

## â“ ã‚ˆãã‚ã‚‹è³ªå•

### Q1: ä½•å•ã¾ã§ä½œæˆã§ãã¾ã™ã‹ï¼Ÿ
A: æŠ€è¡“çš„ã«ã¯åˆ¶é™ãªã—ã€‚å®Ÿç”¨çš„ã«ã¯100å•ç¨‹åº¦ã‚’æ¨å¥¨ã€‚

### Q2: ä½œæˆã—ãŸãƒ•ã‚©ãƒ¼ãƒ ã¯ç·¨é›†ã§ãã¾ã™ã‹ï¼Ÿ
A: ã¯ã„ã€Google Formsã®ç·¨é›†ç”»é¢ã§æ‰‹å‹•ç·¨é›†å¯èƒ½ã§ã™ã€‚

### Q3: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ä½¿ãˆã¾ã™ã‹ï¼Ÿ
A: ã„ã„ãˆã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãŒå¿…è¦ã§ã™ã€‚

### Q4: ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§ä½¿ãˆã¾ã™ã‹ï¼Ÿ
A: PCå°‚ç”¨ã§ã™ã€‚

### Q5: ç„¡æ–™ã§ã™ã‹ï¼Ÿ
A: ã¯ã„ã€å®Œå…¨ç„¡æ–™ã§ã™ã€‚

### Q6: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯å¤§ä¸ˆå¤«ã§ã™ã‹ï¼Ÿ
A: Googleå…¬å¼APIã®ã¿ä½¿ç”¨ã€‚ãƒ‡ãƒ¼ã‚¿ã¯è‡ªåˆ†ã®Google Driveã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

- **GitHub**: https://github.com/kyamafiddle60-wq/google-form-generator
- **Issues**: https://github.com/kyamafiddle60-wq/google-form-generator/issues

---

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License - è‡ªç”±ã«ä½¿ç”¨ãƒ»æ”¹å¤‰ãƒ»é…å¸ƒå¯èƒ½

---

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0  
**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ16æ—¥  
**ä½œæˆè€…**: AI Assistant
